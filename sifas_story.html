<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ratius55">
<meta name="twitter:creator" content="@ratius55">
<meta name="twitter:title" content="スクフェスALL STARS ストーリー便覧">
<meta name="twitter:description" content="スクスタのメインストーリー・イベントストーリー・キズナエピソードのあらすじ・登場人物のまとめです。">

<title>スクフェスALL STARS ストーリー便覧</title>
<link rel="icon" type="image/png" href="img/favicon.png">
<link rel="stylesheet" href="main.css">
<style><!--

p{
	margin: 15px 10px;
}
ul{
	margin: 0 auto 5px 5px;
}

.StoryTable {
	width: 750px;
	border-collapse: collapse;
	border-width: 2px;
	border-style: solid;
	margin: 15px;
}

.StoryTable thead td{
	position: relative;
	padding: 0;
	height: 45px;
	border: 2px;
	border-style: solid;
	border-color: inherit;
}

.main   { border-color: #68a0af; background-color: #bae3ee; }
.event  { border-color: #c6a073; background-color: #ffe4c4; }

.StoryTable tbody td {
	padding: 5px 10px;
	line-height: 165%;
	border-width: 1px;
	border-style: solid;
	border-color: inherit;
	background-color: rgba(255, 255, 255, 0.4);
}

.StoryTable .LeftColumn {
	width: 90px;
	text-align: center;
}

.StoryTable .RightColumn {
	background-color: white;
}

.EventContainer h4 {
	background-color:#bbf;
}

.CharButton {
	display: inline-block;
	text-align: center;
	vertical-align: middle;
	height: 22px;
	padding: 0 6px;
	border: 2px solid;
	border-radius: 13px;
	line-height: 140%;
}

.story-type {
	display: block;
	width: 790px;
	margin-left: 8px;
	color: #666;
	font-size: small;
}

.story-title {
	display: block;
	width: 775px;
	margin-left: 23px;
	font-size: 140%;
	font-weight: bold;
}
.excluded { display: none; }
.transparent { color: #888; opacity: 0.5; }

--></style>
<script><!--
const CharLookUpTable = [
	{"number":0 , "id": "Honoka",   "name": "穂乃果", "r":255, "g":163, "b": 54 },
	{"number":1 , "id": "Eli",      "name": "絵里",   "r":122, "g":238, "b":255 },
	{"number":2 , "id": "Kotori",   "name": "ことり", "r":206, "g":191, "b":191 },
	{"number":3 , "id": "Umi",      "name": "海未",   "r": 23, "g":105, "b":255 },
	{"number":4 , "id": "Rin",      "name": "凛",     "r":219, "g":212, "b": 30 },
	{"number":5 , "id": "Maki",     "name": "真姫",   "r":255, "g": 80, "b": 62 },
	{"number":6 , "id": "Nozomi",   "name": "希",     "r":196, "g": 85, "b":246 },
	{"number":7 , "id": "Hanayo",   "name": "花陽",   "r":106, "g":230, "b":115 },
	{"number":8 , "id": "Nico",     "name": "にこ",   "r":255, "g": 79, "b":145 },
	{"number":9 , "id": "Chika",    "name": "千歌",   "r":255, "g":149, "b": 71 },
	{"number":10, "id": "Riko",     "name": "梨子",   "r":255, "g":158, "b":172 },
	{"number":11, "id": "Kanan",    "name": "果南",   "r": 39, "g":193, "b":183 },
	{"number":12, "id": "Dia",      "name": "ダイヤ", "r":219, "g":  8, "b": 57 },
	{"number":13, "id": "You",      "name": "曜",     "r":102, "g":192, "b":255 },
	{"number":14, "id": "Yoshiko",  "name": "善子",   "r":193, "g":202, "b":212 },
	{"number":15, "id": "Hanamaru", "name": "花丸",   "r":255, "g":208, "b": 16 },
	{"number":16, "id": "Mari",     "name": "鞠莉",   "r":194, "g": 82, "b":198 },
	{"number":17, "id": "Ruby",     "name": "ルビィ", "r":255, "g":111, "b":190 },
	{"number":18, "id": "Ayumu",    "name": "歩夢",   "r":255, "g":191, "b":224 },
	{"number":19, "id": "Kasumi",   "name": "かすみ", "r":213, "g":222, "b":112 },
	{"number":20, "id": "Shizuku",  "name": "しずく", "r":187, "g":237, "b":255 },
	{"number":21, "id": "Karin",    "name": "果林",   "r": 74, "g": 47, "b":237 },
	{"number":22, "id": "Ai",       "name": "愛",     "r":255, "g":130, "b": 70 },
	{"number":23, "id": "Kanata",   "name": "彼方",   "r":190, "g":130, "b":255 },
	{"number":24, "id": "Setsuna",  "name": "せつ菜", "r":246, "g": 14, "b": 14 },
	{"number":25, "id": "Emma",     "name": "エマ",   "r":143, "g":218, "b":121 },
	{"number":26, "id": "Rina",     "name": "璃奈",   "r":208, "g":206, "b":225 },
	{"number":27, "id": "Shioriko", "name": "栞子",   "r": 36, "g":189, "b":139 },
	{"number":100,"id": "Player",   "name": "あなた", "r":160, "g":192, "b":160 },

	{"number":200,"id": "Yukiho",   "name": "雪穂",    "r":128, "g": 80, "b":112 },
	{"number":300,"id": "456",      "name": "よいつむ","r": 80, "g":112, "b":128 },
	{"number":400,"id": "Misato",   "name": "美里",    "r":128, "g":112, "b": 80 },
	{"number":450,"id": "Hanpen",   "name": "はんぺん","r":128, "g":112, "b": 80 }
];

//	{"number":401,"id": "Arisa",    "name": "亜里沙",  "r":128, "g": 80, "b":112 },
//	{"number":401,"id": "Haruka",   "name": "遥",      "r":128, "g":112, "b": 80 },
//	{"number":402,"id": "Kaoruko",  "name": "薫子",    "r":128, "g":112, "b": 80 },
//	{"number":403,"id": "Mai",      "name": "マイ",    "r":128, "g":112, "b": 80 },
//	{"number":404,"id": "Haruka",   "name": "遥",      "r":128, "g":112, "b": 80 },


let Narrowed = ""; //現在の絞り込み対象


//■■データ取得用
//■キャラクター用のルックアップテーブル (ID, データ種)
function LookUp(id, data){
	var temp = CharLookUpTable.filter((u)=>{return(u.id === id);});
	if(temp.length){
		return temp[0][data];
	} else {
		console.log("キャラクターID " + id +" は見つかりません");
		if(data === "number" || data === "r" || data === "g" || data === "b"){
			return -1;
		} else {
			return "";
		}
	}
}

//■■描画用
//■絞り込みボタンの描画
function DrawNarrowingButtons(){
	var Output = '<div style="line-height: 200%">';
	for(temp1 of CharLookUpTable){
		Output += DrawButton(temp1.id);
		if(temp1.number == 8 || temp1.number == 17 || temp1.number == 27 || temp1.number == 100){
			Output += '<br>';
		}
	}
	Output += '<\/div>';
	return Output;
}

//■各ストーリーの描画
function DrawEventList(){
	var Output = '<div id="StoryArea">';
	
	for(temp1 of StoryList){
		if(!temp1.character){continue;} //登場人物が設定されていない場合、描画しない
		if(temp1.character.length == 0){continue;}
		
		Output += '<table class="StoryTable ' + temp1.type;
		
		for(temp2 of temp1.character){
			Output += ' ' + temp2;
		}
		Output += '"';
		if(temp1.type == "kizuna"){ //キズナエピソードはキャラクターの色を用いる
			Output += ' style="background-color:rgb('
			+ Math.floor((LookUp(temp1.color, "r")+255)/2) + ','
			+ Math.floor((LookUp(temp1.color, "g")+255)/2) + ','
			+ Math.floor((LookUp(temp1.color, "b")+255)/2) + '); border-color:rgb('
		
			+ Math.floor((LookUp(temp1.color, "r")*7+192)/10) + ','
			+ Math.floor((LookUp(temp1.color, "g")*7+192)/10) + ','
			+ Math.floor((LookUp(temp1.color, "b")*7+192)/10) + ');"'
		}
		Output += '>\n<thead>\n'
		+ '<tr><td colspan="2">'
		+ '<div class="story-type">' + temp1.chapter + '<\/div>'
		+ '<div class="story-title"><span>' + temp1.title + '<\/span><\/div><\/td><\/tr>'
		+ '<\/thead>\n'
		
		+ '<tbody>\n';
		
		if(temp1.desc){ //あらすじが有るなら
			Output += '<tr><td class="LeftColumn">あらすじ<\/td>'
			+ '<td class="RightColumn">' + temp1.desc + '<\/td><\/tr>\n';
		}
		if(temp1.memo){ //メモが有るなら
			Output += '<tr><td class="LeftColumn">メモ<\/td>'
			+ '<td class="RightColumn">' + temp1.memo + '<\/td><\/tr>\n';
		}

		Output += '<tr><td class="LeftColumn">登場人物<\/td><td class="RightColumn">';
		
		for(temp2 of temp1.character){
			Output += DrawButton(temp2);
		}
		
		Output += '<\/td><\/tr>\n<\/tbody>\n<\/table>\n'
	}
	
	Output += '<\/div>';
	return Output;
}

//■絞り込み用のボタンを描画
function DrawButton(character){
	if(LookUp(character, "id") === ""){ return "";} //存在しないキャラクターなら描画しない

	var Output = '<span class="CharButton button-' + character
	+ '" style="background-color:rgb('
	+ Math.floor((LookUp(character, "r")+510)/3) + ','
	+ Math.floor((LookUp(character, "g")+510)/3) + ','
	+ Math.floor((LookUp(character, "b")+510)/3) + '); border-color: rgb('
	+ LookUp(character, "r") + ','
	+ LookUp(character, "g") + ','
	+ LookUp(character, "b") + ');" onclick="Narrowing(' + "'" + character + "'" + ')">'
	+ LookUp(character, "name") + '<\/span>\n';
	return Output;
}

//■■その他処理
//■絞り込み処理
function Narrowing(target){
	if(target == Narrowed){ ClearNarrowing(); return 0;}
	var elements = document.getElementsByClassName("StoryTable");
	for(temp1 of elements){
		if(temp1.classList.contains(target)){ //絞り込みに該当するなら
			temp1.classList.remove("excluded");
		} else {
			temp1.classList.add("excluded");
		}
	}

	var elements = document.getElementsByClassName("CharButton");
	for(temp1 of elements){
		if(temp1.classList.contains('button-' + target)){ //絞り込みに該当するなら
			temp1.classList.remove("transparent");
		} else {
			temp1.classList.add("transparent");
		}
	}
	Narrowed = target;
}

function ClearNarrowing(target){
	var elements = document.getElementsByClassName("StoryTable");
	for(temp1 of elements){
		temp1.classList.remove("excluded");
	}

	var elements = document.getElementsByClassName("CharButton");
	for(temp1 of elements){
		temp1.classList.remove("transparent");
	}
	Narrowed = "";
	return 0;
}

--></script>

</head>

<body>

<div id="MainArea">
	<div style="text-align:center; margin-top: 40px;">
	<span style="font-size: 150%; font-weight: bold;">よみこみちゅう…</span><br>
	このコンテンツはJavaScriptを使用しています。<br>
	いつまで待ってもこの表示が消えない場合、JavaScriptがオフになっている可能性があります。<br>
	お手数ですが、JavaScriptの実行を許可した上でページを読み込み直してください。<br>
	</div>
</div>

<script><!--

function loadScript(src, callback) {
    var done = false;
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.src = src;
    head.appendChild(script);
    // Attach handlers for all browsers
    script.onload = script.onreadystatechange = function() {
        if ( !done && (!this.readyState ||
                this.readyState === "loaded" || this.readyState === "complete") ) {
            done = true;
            callback();
            // Handle memory leak in IE
            script.onload = script.onreadystatechange = null;
            if ( head && script.parentNode ) {
                head.removeChild( script );
            }
        }
    };
}

loadScript("data/stories.js", function() {

	document.getElementById("MainArea").innerHTML =
	'<h2>スクフェスALL STARS ストーリー便覧<\/h2>'
	+ '<h3 style="background-color:#ddd; color:#777; border-color:#999;">まえがき<\/h3>'
	+ '<p>スクフェスALL STARSにおける「メインストーリー」「イベントストーリー」「キズナエピソード」の一覧です。<br>「登場人物」のキャラクター名をクリック/タップすることで、絞り込むことができます。<br>イベントストーリーは、公式によるあらすじが設定されていませんが、ネタバレにならない程度に独自にあらすじを加えてあります。<\/p>'
	
	+ '<p><span style="font-weight:bold;">実装済データ<\/span><\/p><ul>'
	+ '<li><span class="main">メインストーリー<\/span>：第1～4・18章<\/li>'
	+ '<li><span class="event">イベントストーリー<\/span>：「和装モデルはお任せあれ！」まで<\/li>'
	+ '<li>キズナエピソード：<ul>'
	+ '<li>μ&#39;s：穂乃果・ことり・凛 (各12話まで)<\/li>'
	+ '<li>Aqours：ルビィ（各11話まで）<\/li>'
	+ '<li>ニジガク：愛・璃奈 (各21話まで) 栞子 (6話まで)<\/li>'
	+ '<\/ul>'
	+ '<li>サイドエピソード：実装予定なし<\/li>'
	+ '<\/ul>'
	
	+ '<h3 class="muse">絞り込み用ボタン<\/h3>'
	+ DrawNarrowingButtons()

	+ '<h3 class="aqours">ストーリー一覧<\/h3>'
	+ DrawEventList();
});
--></script>

<h3 class="niji">更新履歴</h3>
<table class="history">
<tbody>
<tr>
	<td>2020/09/16 10:00頃</td>
	<td><!--<span class="new"></span>-->テスト公開</td>
</tr>
</tbody>
</table>

<!--<p>
<a href="index.html">トップページに戻る。</a>
</p>-->

</body>
</html>