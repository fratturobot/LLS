<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ratius55">
<meta name="twitter:creator" content="@ratius55">
<meta name="twitter:title" content="スクフェスALL STARS 過去のイベントまとめ">
<meta name="twitter:description" content="スクスタのイベントストーリーで開催されたイベント、および共演したペアのまとめです。">

<title>スクフェスALL STARS 過去のイベントまとめ</title>
<link rel="icon" type="image/vnd.microsoft.icon" href="img/favicon.ico">
<link rel="stylesheet" href="main.css">
<link rel="stylesheet" href="color_sifas.css">
<style><!--

#EventList, #Trio-Table {
	margin: 10px;
	border: solid 3px rgb(226,6,126);
	border-collapse: collapse;
}

#EventList thead, #Trio-Table thead{
	padding: 2px 5px;
	background-color: rgba(226, 006, 126, 0.3);
	border-bottom: solid 2px rgb(226,6,126);
}

#EventList thead tr:first-child th{
	border-right: solid 1px rgb(226,6,126);
}

#EventList thead tr:nth-child(2){
	background-color: #ffdbef;
}

#EventList tbody td{
	padding: 2px 5px;
	border: solid 1px #ccc;
}

#Single-Table {
	width: 100%;
	text-align: center;
	border-collapse: collapse;
	border: 2px solid #00a0ea;
}

td.sttd {
	border-right: 1px solid #aaa;
	border-bottom: 1px solid #aaa;
}

#Pair-Table {
	width: 100%;
	height: 80vh;
	text-align: center;
	border-collapse: collapse;
	border: 4px solid #f29600;
}

#Pair-Table td{
	padding: 0;
}

.PT-Top       { overflow-x: hidden; height: 28px; border-bottom: 2px solid #973;}
.PT-Top tr    { height: 28px; }
.PT-Bottom    { overflow-x: scroll; height: calc(80vh - 30px);}
.PT-Bottom tr { height: 59px; }
.PT-Left      { overflow-y: hidden; width: 62px; border-right: 2px solid #973;}
.PT-Left th   { width: 60px;}
.PT-Right     { overflow-y: scroll; width: calc(100vw - 102px); margin-right: 0;}
.PT-Right td, div.PT-Right th { width: 74px; }

.quarter-table {
	border-collapse: collapse;
	padding: 1px 0;
	text-align:center;
}

#PT-TL { background-color: #dbf4ff; }

.PT-Right > .quarter-table th,
.PT-Right > .quarter-table td {
	border-right: 1px solid #aaa;
}
.PT-Bottom > .quarter-table tr {
	border-bottom: 1px solid #aaa;
}
.quarter-table td { color: #999; }

.bg_Lanzhu{ font-size:10pt;}

#Trio-Border{
	overflow-y: scroll;
	border: solid 3px rgb(226,6,126);
	height: calc(70vh - 30px);
	background-color: rgba(226,126,176,0.1);
}

#Trio-Table tbody th{
	padding: 5px;
	border-top: solid 1px #aaa;
	border-right: solid 1px #aaa;
}
#Trio-Table tbody td{
	padding: 5px;
	font-size: small;
	border-top: solid 1px #aaa;
	border-right: solid 1px #aaa;
}

.shadowname {
	color: white;
	filter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.7));
}

td.bg_tp_white{
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAQCAMAAAAcVM5PAAAAMFBMVEWEhISHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7vAwMC/AbLaAAAALElEQVR42jXBtwHAIADAMNNLAvz/LYuROGKLJX7xiSmG6KKJKorIIokogngubj8DwatbdggAAAAASUVORK5CYII=);
	background-size:contain;
	background-blend-mode: screen;
}
.EventBox {
	display: inline-block;
	text-align: center;
	vertical-align: middle;
	width: 18px;
	height: 18px;
	line-height: 18px;
	border: 1px solid #666;
	border-radius: 10px;
	margin: 0 1px;
}

.EventBox span {
	font-size: small;
	font-weight: bold;
	vertical-align: middle;
}

--></style>
<script><!--

const CharId = ['Honoka', 'Eli', 'Kotori', 'Umi', 'Rin', 'Maki', 'Nozomi', 'Hanayo', 'Nico',
		'Chika', 'Riko', 'Kanan', 'Dia', 'You', 'Yoshiko', 'Hanamaru', 'Mari', 'Ruby',
		'Ayumu', 'Kasumi', 'Shizuku', 'Karin', 'Ai', 'Kanata', 'Setsuna', 'Emma', 'Rina', 'Shioriko', 'Mia', 'Lanzhu'];

const CharLookUpTable = [
	{"number":-1, "id": "",         "name": "",       "color": "white", "group": "M"},
	{"number":0 , "id": "Honoka",   "name": "穂乃果", "color": "black", "group": "M"},
	{"number":1 , "id": "Eli",      "name": "絵里",   "color": "black", "group": "M"},
	{"number":2 , "id": "Kotori",   "name": "ことり", "color": "black", "group": "M"},
	{"number":3 , "id": "Umi",      "name": "海未",   "color": "white", "group": "M"},
	{"number":4 , "id": "Rin",      "name": "凛",     "color": "black", "group": "M"},
	{"number":5 , "id": "Maki",     "name": "真姫",   "color": "white", "group": "M"},
	{"number":6 , "id": "Nozomi",   "name": "希",     "color": "white", "group": "M"},
	{"number":7 , "id": "Hanayo",   "name": "花陽",   "color": "black", "group": "M"},
	{"number":8 , "id": "Nico",     "name": "にこ",   "color": "white", "group": "M"},
	{"number":9 , "id": "Chika",    "name": "千歌",   "color": "black", "group": "A"},
	{"number":10, "id": "Riko",     "name": "梨子",   "color": "black", "group": "A"},
	{"number":11, "id": "Kanan",    "name": "果南",   "color": "black", "group": "A"},
	{"number":12, "id": "Dia",      "name": "ダイヤ", "color": "white", "group": "A"},
	{"number":13, "id": "You",      "name": "曜",     "color": "black", "group": "A"},
	{"number":14, "id": "Yoshiko",  "name": "善子",   "color": "black", "group": "A"},
	{"number":15, "id": "Hanamaru", "name": "花丸",   "color": "black", "group": "A"},
	{"number":16, "id": "Mari",     "name": "鞠莉",   "color": "white", "group": "A"},
	{"number":17, "id": "Ruby",     "name": "ルビィ", "color": "black", "group": "A"},
	{"number":18, "id": "Ayumu",    "name": "歩夢",   "color": "black", "group": "N"},
	{"number":19, "id": "Kasumi",   "name": "かすみ", "color": "black", "group": "N"},
	{"number":20, "id": "Shizuku",  "name": "しずく", "color": "black", "group": "N"},
	{"number":21, "id": "Karin",    "name": "果林",   "color": "white", "group": "N"},
	{"number":22, "id": "Ai",       "name": "愛",     "color": "black", "group": "N"},
	{"number":23, "id": "Kanata",   "name": "彼方",   "color": "white", "group": "N"},
	{"number":24, "id": "Setsuna",  "name": "せつ菜", "color": "white", "group": "N"},
	{"number":25, "id": "Emma",     "name": "エマ",   "color": "black", "group": "N"},
	{"number":26, "id": "Rina",     "name": "璃奈",   "color": "black", "group": "N"},
	{"number":27, "id": "Shioriko", "name": "栞子",   "color": "white", "group": "N"},
	{"number":28, "id": "Mia",      "name": "ミア",   "color": "black", "group": "N"},
	{"number":29, "id": "Lanzhu",   "name": "ランジュ","color": "black", "group": "N"}
];

const PairTableWidth = 100;

//■■各種関数
//■Date型を「YYYY/MM/DD (hh:mm)」という文字列に変換
function GetStringFromDate(date,hm){
	temp = new Date(date);
	
	if(temp.getFullYear() == 1970){ //取得失敗などの理由で1970年になった場合、空文字列を返す
		console.log("Error: " + temp + "may not be a date");
		return "";
	}
	temp2 = temp.getFullYear()
	+ "/" + ("00" + (temp.getMonth()+1)).slice(-2)
	+ "/" + ("00" + (temp.getDate())).slice(-2);
	if(hm){
		temp2 += " " + ("00" + (temp.getHours())).slice(-2)
		+ ":" + ("00" + (temp.getMinutes())).slice(-2);
	}
	return temp2;
}

//■キャラクター用のルックアップテーブル (ID, データ種)
function LookUp(id, data){
	var temp = CharLookUpTable.filter((u)=>{return(u.id === id);});
	if(temp.length == 0){ //データが見つからず、空配列を返した場合
		console.log("キャラクターID " + id + " は見つかりません");
		if(data === "number"){
			return -1;
		} else {
			return "";
		}
	} else {
		return temp[0][data];
	}
}

//■イベント用のルックアップテーブル (イベントNo., データ種)
function LookUpEvent(id, data){
	return EventList.filter((u)=>{return(u.id === id);})[0][data];
}


//■■描画用関数
//■イベントリスト
function WriteEventList(){
	var Output = '<table id="EventList">\n';

	//■ヘッダー
	Output += '<thead>\n<tr class="header-top">\n'
	+ '<th rowspan="2">No.<\/th><th rowspan="2">イベント名<\/th><th rowspan="2">タイプ<\/th><th rowspan="2">開催期間<\/th><th colspan="2">参加キャラクター<\/th><\/tr>\n'
	+ '<tr><th>UR<\/th><th>SR<\/th<\/tr>\n<\/thead>\n<tbody>\n';

	//■メイン
	for(y of EventList){
		Output += '<tr><td style="text-align:center;">' + y.id
		+ '<\/td><td>' + y.name
		+ '<\/td><td style="font-size: small; text-align:center;';
		switch(y.type) {
			case "story":
				Output += ' background-color:#cef;">ストーリー';
				break;
			case "exchange":
				Output += ' background-color:#fdc;">交換所';
				break;
			default:
				Output += '">' + y.type;
		}
		Output += '<\/td><td style="font-size: small;">開始：' + GetStringFromDate(y.started, true) + '<br>'
		+ '終了：' +  GetStringFromDate(y.ended, true)
		+ ' (' + Math.round((y.ended - y.started)/86400000) + '日間)'
		+ '<\/td><td style="font-size: small;">';

		if(y["UR"]){
			for(z=0; z<y.UR.length; z++){
				Output += LookUp(y.UR[z], 'name');
				if(z < y.UR.length-1){ Output += '、';}
			}
		}
		Output += '<\/td><td style="font-size: small;">';
		
		if(y["SR"]){
			for(z=0; z<y.SR.length; z++){
				Output += LookUp(y.SR[z], 'name');
				if(z < y.SR.length-1){ Output += '、';}
			}
		}
		Output +=  '<\/td><\/tr>';
	}
	Output += '<\/tbody>\n<\/table>\n';
	return Output;
}

//■トリオ用のデータ集計。最大4重の配列で格納する
//  TrioHistory[a][0]   は、メンバーaの出席状況の配列
//  TrioHistory[a][b][0]は、メンバーa・a+bの共演状況の配列
//  TrioHistory[a][b][c]は、メンバーa・a+b・a+b+cの共演状況の配列

let TrioHistory = new Array(CharId.length);
for(temp1=0; temp1<CharId.length; temp1++){
	TrioHistory[temp1] = new Array(CharId.length - temp1);
	TrioHistory[temp1][0] = [];
	
	for(temp2=1; temp2<TrioHistory[temp1].length; temp2++){
		TrioHistory[temp1][temp2] = new Array(CharId.length - temp1 - temp2);
		TrioHistory[temp1][temp2][0] = [];
		
		for(temp3=1; temp3<TrioHistory[temp1][temp2].length; temp3++){
			TrioHistory[temp1][temp2][temp3] = [];
		}
	}
}
//表にデータを埋め込む
function MakeTrioData(){
	//各イベントに埋め込まれた、参加キャラクターを見る
	for(i=0; i<EventList.length; i++){
		var temp1 = EventList[i].UR.concat(EventList[i].SR);
		
		var temp2= new Array();
		for(var j=0; j<temp1.length; j++){
			temp2[j] = LookUp(temp1[j],"number");
		}
		temp2 = temp2.sort(function(a,b){return a-b}); //イベント参加者のIDを昇順に並べ替えて
		
		while(temp2[0] == -1){
			if(temp2.length < 3){ break;}
			temp2 = temp2.slice(1);
		}
		if(temp2.length < 3){ //トリオも生成できない場合、無かったことにする
			continue;
		}
		
		//そこからソロ・ペア・トリオのデータを生成
		for(var c1=0; c1<temp2.length; c1++){
			TrioHistory[temp2[c1]][0].push(EventList[i].id);
			if(c1>temp1.length-2){ break; }

			for(var c2=c1+1; c2<temp2.length; c2++){
				TrioHistory[temp2[c1]][temp2[c2]-temp2[c1]][0].push(EventList[i].id);
				if(c2>temp1.length-1){ break; }

				for(var c3=c2+1; c3<temp2.length; c3++){
					TrioHistory[temp2[c1]][temp2[c2]-temp2[c1]][temp2[c3]-temp2[c2]].push(EventList[i].id);
				}
			}
		}
	}
}

// ■「キャラクター登場状況」テーブルの作成（キャラ別）
function DrawSingleTable(CharList){
	//■ヘッダー
	var maxnumber = 0;
	var Output = '<table id="Single-Table">\n<thead>\n<tr>\n';
	for(x of CharList){
		if(x>=0){ //空白でないなら
			if(maxnumber < TrioHistory[x][0].length){ maxnumber = TrioHistory[x][0].length; }
			Output += '<th class="bg_' + CharId[x] + '" style="width:' + (100/CharList.length) + '%">'
			+ '<strong class="shadowname">' + LookUp(CharId[x],"name") + '<\/strong><\/th>\n';
		} else {
			Output += '<th style="width:' + (100/CharList.length) + '%"><\/th>\n';
		}
	}
	Output += '<\/tr>\n<\/thead>\n<tr>';
	
	//■回数
	for(x of CharList){
		if(x>=0){ //空白でないなら
			Output += '<td class="sttd">' + TrioHistory[x][0].length + '回<br></td>';
		} else {
			Output += '<td><\/td>'
		}
	}
	Output += '<\/tr><tr>';
	
	//■ボタン
	Output += '<\/tr>';
	for(x of CharList){
		if(x>=0){ //空白でないなら
			var temp1 = TrioHistory[x][0];
			Output += '<td class="sttd bg_tp_white bg_' + CharId[x] + '">';
			for(y of temp1){
				Output += '<div class="EventBox bg_' + CharId[x] + '" title="'
				+ LookUpEvent(y,"name") + '\n('
				+ GetStringFromDate(LookUpEvent(y,"started"), false) + '～'
				+ GetStringFromDate(LookUpEvent(y,"ended"), false) + ')'
				+ '" style="color:' + LookUp(CharId[x],"color") + '">'
				+ '<span>' + y + '<\/span><\/div>';
				
			}
			Output += '<\/td>'
		} else {
			Output += '<td><\/td>'
		}
	}
	
	Output += '<\/tbody>\n<\/table>';
	return Output;
}

// ■「ペア共演状況」テーブルの作成
function DrawPairTable(){

	//■親テーブル
	var Output = '<table id="Pair-Table">\n<thead>\n<tr>\n';

		//■左上
		Output += '<td>\n<div class="PT-Top PT-Left" id="PT-TL"><\/div><\/td>\n';

		//■右上
		Output += '<td><div class="PT-Top PT-Right" id="PT-TR">\n'
		+ '<table class="quarter-table" style="width: ' + (CharId.length*PairTableWidth) + 'px">\n<thead>\n<tr>\n';
		for(x of CharId){
			//キャラクター名取得
			Output += '<th class="bg_' + x + '"><strong class="shadowname">'
			+ LookUp(x,"name") + '<\/strong><\/th>\n';
		}
		Output += '<\/tr>\n<\/thead>\n<\/table>\n<\/div>\n<\/td>';
	
	Output += '<\/tr>\n<\/thead>\n<tbody>\n<tr>';
	
		//■左下
		Output += '<td><div class="PT-Bottom PT-Left" id="PT-BL">\n'
		+ '<table class="quarter-table">\n<tbody>\n';
		
		for(y of CharId){
			Output += '<tr><th class="bg_' + y + '"><strong class="shadowname">'
			+ LookUp(y,"name") + '<\/strong><\/th><\/tr>\n';
		}
		Output += '<\/tbody>\n<\/table>\n<\/div><\/td>\n';

		//■右下
		Output += '<td><div class="PT-Bottom PT-Right" id="PT-BR" onscroll="SyncScroll();">\n'
		+ '<table class="quarter-table" style="width: ' + (CharId.length*PairTableWidth) + 'px">\n<tbody>\n';
		for(y of CharId){
			Output += '<tr>\n';
			for(x of CharId){
				if(x === y){ //同キャラは灰色でいい
					Output += '<td style="background-color:#aaa"><\/td>\n';
				}else {
					var CirclesInRow = 0;
					Output += '<td class="bg_tp_white bg_' + y + '">'
					
					var temp1 = [LookUp(x,"number"),LookUp(y,"number")].sort(function(a,b){return a-b});

					if(TrioHistory[temp1[0]][temp1[1]-temp1[0]][0].length == 0){
						Output += '－';
					}

					for(z of TrioHistory[temp1[0]][temp1[1]-temp1[0]][0]){
						Output += '<div class="EventBox bg_' + x + '" title="'
						+ LookUp(x,"name") + '・' + LookUp(y,"name") + '\n'
						+ LookUpEvent(z,"name") + '\n('
						+ GetStringFromDate(LookUpEvent(z,"started"), false) + '～'
						+ GetStringFromDate(LookUpEvent(z,"ended"), false) + ')'
						+ '" style="color:' + LookUp(x,"color") + '">'
						+ '<span>' + z + '<\/span><\/div>';
						
						if(++CirclesInRow == 40){ //改行処理
							Output += '<br>';
							CirclesInRow = 0;
						}
					}
					Output += '<\/td>\n';
				}
			}
			Output += '<\/tr>\n';
		}

	Output += '<\/table><\/div><\/td>\n<\/tr>\n<\/tbody>\n<\/table>';
	return Output;
}

// ■「トリオ重複状況」テーブルの作成
function DrawDuplicatedTrioList(){
	var Output = '<div id="Trio-Border"><table id="Trio-Table">\n'
	+ '<thead>\n<tr>\n<th colspan="3">重複トリオ<\/th><th>参加イベント<\/th><\/tr><\/thead>\n<tbody>'

	for(temp1=0; temp1<TrioHistory.length; temp1++){
		for(temp2=1; temp2<TrioHistory[temp1].length; temp2++){
			for(temp3=1; temp3<TrioHistory[temp1][temp2].length; temp3++){
				if(TrioHistory[temp1][temp2][temp3].length > 1){
					Output += '<tr>'
					+ '<th class="bg_' + CharId[temp1] + '"><span class="shadowname">'
					+ LookUp(CharId[temp1],"name") + '<\/span><\/th>'
					+ '<th class="bg_' + CharId[temp1+temp2] + '"><span class="shadowname">'
					+ LookUp(CharId[temp1+temp2],"name") + '<\/span><\/th>'
					+ '<th class="bg_' + CharId[temp1+temp2+temp3] + '"><span class="shadowname">'
					+ LookUp(CharId[temp1+temp2+temp3],"name") + '<\/span><\/th>'
					+ '<td style="background-color: white;">';
					
					for(temp4 of TrioHistory[temp1][temp2][temp3]){
						Output += LookUpEvent(temp4,"name") + '<br>';
					}
					Output += '<\/td><\/tr>\n';
				}
			}
		}
	}
	Output += '<\/tbody>\n<\/table><\/div>';
	return Output;
}

//■スクロールバー連動
function SyncScroll() {
	document.getElementById('PT-TR').scrollLeft = document.all('PT-BR').scrollLeft;
	document.getElementById('PT-BL').scrollTop = document.all('PT-BR').scrollTop;
}

--></script>

</head>
<body>
<div id="MainArea">
	<div style="text-align:center; margin-top: 40px;">
	<span style="font-size: 150%; font-weight: bold;">よみこみちゅう…</span><br>
	このコンテンツはJavaScriptを使用しています。<br>
	いつまで待ってもこの表示が消えない場合、JavaScriptがオフになっている可能性があります。<br>
	お手数ですが、JavaScriptの実行を許可した上でページを読み込み直してください。<br>
	</div>
</div>

<script><!--

function loadScript(src, callback) {
    var done = false;
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.src = src;
    head.appendChild(script);
    // Attach handlers for all browsers
    script.onload = script.onreadystatechange = function() {
        if ( !done && (!this.readyState ||
                this.readyState === "loaded" || this.readyState === "complete") ) {
            done = true;
            callback();
            // Handle memory leak in IE
            script.onload = script.onreadystatechange = null;
            if ( head && script.parentNode ) {
                head.removeChild( script );
            }
        }
    };
}

loadScript("data/events.js", function() {
	var CardList = [];
	MakeTrioData();

	document.getElementById("MainArea").innerHTML =
	'<h2>スクフェスALL STARS 過去のイベントまとめ<\/h2>'
	+ '<h3 style="background-color:#ddd; color:#777; border-color:#999;">まえがき<\/h3>'
	+ '<p>スクフェスALL STARSのイベントストーリーおける、各ペアの共演状況です。<br>PCで閲覧している場合、イベント番号の書かれた丸にカーソルを当てることで詳しい情報のツールチップが出現します。<\/p>'
	
	+ '<h3 class="muse">イベント一覧<\/h3>'
	+ WriteEventList()

	+ '<h3 class="aqours">キャラクター登場状況<\/h3>'
	+ DrawSingleTable([0,1,2,3,4,5,6,7,8])
	+ DrawSingleTable([9,10,11,12,13,14,15,16,17])
	+ DrawSingleTable([18,19,20,21,22,23,24,25,26])
	+ DrawSingleTable([27,28,29,-1,-1,-1,-1,-1,-1])
	
	+ '<h3 class="niji">ペア共演状況<\/h3>'
	+ DrawPairTable()
	
	+ '<h3 class="muse">トリオ重複状況<\/h3>'
	+ DrawDuplicatedTrioList()
	;
});
--></script>

<h3 class="niji">更新履歴</h3>
<table class="history">
<tbody>
<tr>
	<td>2021/11/06</td>
	<td><span class="fix"></span>「キャラクター登場状況」の表のレイアウトを調整</td>
</tr>
<tr>
	<td>2021/10/09</td>
	<td><span class="new"></span>ミア・ランジュが表示可能になりました！</td>
</tr>
<tr>
	<td>2021/06/02</td>
	<td><span class="new"></span>栞子が表示可能になりました！<br>
		<span class="fix"></span>「ペア共演状況」のレイアウト調整</td>
</tr>
<tr>
	<td>2020/09/03</td>
	<td><span class="new"></span>「トリオ重複状況」を追加</td>
</tr>
<tr>
	<td>2020/08/02</td>
	<td><span class="new"></span>「イベント一覧」のテーブルに「参加キャラクター」を追加</td>
</tr>
<tr>
	<td>2020/07/31</td>
	<td><span class="new"></span>「キャラクター登場状況」を追加</td>
</tr>
<tr>
	<td>2020/07/07</td>
	<td><span class="fix"></span>一部環境でイベント日時が正しく表示されない不具合を修正</td>
</tr>
<tr>
	<td rowspan="2">2020/07/05</td>
	<td><span class="new"></span>「イベント一覧」に情報を追加</td>
</tr>
<tr>
	<td><span class="fix"></span>「ペア共演状況」の表</td>
</tr>
<tr>
	<td>2020/07/05</td>
	<td><span class="fix"></span>レイアウト調整</td>
</tr>
<tr>
	<td>2020/07/05</td>
	<td><span class="new"></span>公開</td>
</tr>
</tbody>
</table>

<p>
<a href="index.html">トップページに戻る。</a>
</p>

</body>
</html>