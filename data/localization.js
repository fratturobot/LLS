const Localization = {
  'LANG_CODE': [
    'JP',
    'EN'
  ],
  'LANG_NAME': [
    '日本語',
    'English'
  ],
  // HOMEPAGE
  'SITE_TITLE': [
    'ラブライブ！ストレージ',
    'Love Live! Storage'
  ],
  'CHOOSE_PANEL': [
    '↓ 見たいパネルを選んでね ↓',
    '↓ Select a Panel ↓'
  ],
  'SMARTPHONE_WARNING': [
    'ボックスの右上に赤い円が表示されている場合、リンク先のページがスマートフォンでの閲覧に最適化されていない可能性があります。',
    'Pages marked with red circles have not been optimized for smartphone display.  Those with yellow circles have not been translated.'
  ],
  /*'GENERAL': [
    '総合',
    'GENERAL'
  ],*/
  'GENERAL_SERIES': [
    'ラブライブ！シリーズ総合',
    'Love Live! Series'
  ],
  'MEMBER_COLOR_TITLE': [
    'メンバーカラー<wbr>まとめ',
    'Member Color Summary'
  ],
  'MEMBER_COLOR_DESC': [
    'スクールアイドル達のメンバーカラーを、色々な媒体から集めてみました。',
    'Image colors of each character as they appear in various official sources.'
  ],
  'CHAR_SORT_TITLE': [
    'キャラソート',
    'Character Sorter'
  ],
  'CHAR_SORT_DESC': [
    'スクールアイドル、ユニット、キャスト等を好きな順に並べ替えてみよう。',
    'Sort School Idols, Subunits, Seiyuu, etc. to order your favorites.'
  ],
  'CALENDAR_TITLE': [
    '誕生日カレンダー',
    'Birthday Calendar'
  ],
  'CALENDAR_DESC': [
    'スクールアイドルやキャストの誕生日を確認できます。スクフェスの転入生にも対応。',
    'Birthdays of the School Idols and Seiyuu, including transfer students.'
  ],
  'NIJI_SERIES': [
    '虹ヶ咲学園スクールアイドル同好会',
    'Nijigasaki High School Idol Club'
  ],
  'NIJI_RANKING_TITLE': [
    '虹ヶ咲学園 <wbr>マンスリーランキング',
    'Nijigasaki Monthly Ranking'
  ],
  'NIJI_RANKING_DESC': [
    '毎月行われていたランキングの結果を、集計・分析してみました。',
    'Results of the monthly ranking votes, tabulated and analyzed.'
  ],
  'NIJI_QUESTION_TITLE': [
    '虹ヶ咲学園 <wbr>マンスリーアンケート',
    'Nijigasaki Monthly Questionaire'
  ],
  'NIJI_QUESTION_DESC': [
    '毎月行われていたアンケートの集計や、便利リンクを掲載しています。',
    'Compilation of the monthly survey results, with links to each one.'
  ],
  'HASU_SERIES': [
    'Link！Like！ラブライブ！',
    'Link! Like! Love Live!'
  ],
  'HASU_CONNECT_TITLE': [
    'スクールアイドル<wbr>コネクト<wbr>まとめ',
    'School Idol Connect Summary'
  ],
  'HASU_CONNECT_DESC': [
    'アプリ内で配信されたWith×MEETS、Fes×LIVEのまとめです。',
    'Summary of With×MEETS and Fes×LIVE results from the app.'
  ],
  'SIF2_SERIES': [
    'スクフェス2 MIRACLE LIVE!',
    'SIF 2: Miracle Live!'
  ],
  'SIF2_THEATER_TITLE': [
    'スクフェス2 <wbr>毎日劇場アーカイブ',
    'SIF2 Daily Theatre Archive'
  ],
  'SIF2_THEATER_DESC': [
    'スクフェス2の毎日劇場の一覧です。本文も収録。',
    'Collection of SIF2 Daily Theatre episodes.'
  ],
  'SIF_SERIES': [
    'スクフェス1',
    'SIF 1'
  ],
  'LIVE_ARENA_TITLE': [
    'ライブ♪アリーナ <wbr>まとめ',
    'Live♪Arena Stories'
  ],
  'LIVE_ARENA_DESC': [
    '今までに開催された、ライブ♪アリーナのテキストを保管しています。',
    'Story data of the Live♪Arena events that have been held so far'
  ],
  'TRANSFER_STUDENT_TITLE': [
    'スクフェス <wbr>転入生データベース',
    'Transfer Student Database'
  ],
  'TRANSFER_STUDENT_DESC': [
    '今はもう見られない、転入生の情報やサイドストーリーを補完しています。',
    'Information and side stories of the transfer students (N Girls).'
  ],
  'SIFAS_SERIES': [
    'スクフェスALL STARS',
    'SIF All Stars'
  ],
  'NAME_TABLE_TITLE': [
    'スクスタ <wbr>呼称表',
    'Names, Nicknames & Honorifics'
  ],
  'NAME_TABLE_DESC': [
    '３０人のスクールアイドルとあなたは、お互いのことをどう呼び合っでいる？',
    'How did the 30 School Idols (and you) refer to each other?'
  ],
  'CARD_IMPL_TITLE': [
    'スクスタ <wbr>実装カード一覧',
    'SIFAS Card List'
  ],
  'CARD_IMPL_DESC': [
    'スクスタに実装されたカードがどれくらいあったかを確認できます。',
    'Details of every character card in All Stars'
  ],
  'EVENT_SUMMARY_TITLE': [
    'スクスタ <wbr>過去のイベント',
    'SIFAS Event Archive'
  ],
  'EVENT_SUMMARY_DESC': [
    'スクスタのイベントストーリーで開催されたイベント、および共演したペアのまとめです。',
    'Data on past events, including featured UR and SR units.'
  ],
  'STORY_SUMMARY_TITLE': [
    'スクスタ <wbr>ストーリー便覧',
    'SIFAS Story Summaries'
  ],
  'STORY_SUMMARY_DESC': [
    'スクスタの各種ストーリーのあらすじと登場キャラを、ひとまとめにしてみました。',
    'Synopses of the story chapters and which characters appeared therein.'
  ],
  'DAILY_THEATRE_TITLE': [
    '毎日劇場<wbr>データベース',
    'SIFAS Daily Theatre'
  ],
  'DAILY_THEATRE_DESC': [
    'スクスタの毎日劇場の一覧です。グループを超えた掛け合いをお楽しみあれ！',
    'List of Daily Theatre episodes.  Enjoy the cross-generation chats!'
  ],
  'SYSTEM_SERIES': [
    'その他',
    'Others'
  ],
  'LINKS_TITLE': [
    'リンク集',
    'External Links'
  ],
  'LINKS_DESC': [
    '公式・非公式問わず、ラブライブ！関連の有用なWebサイトを集めました。',
    'Offical and community websites dedicated to the Love Live! series'
  ],
  'AUTHOR_NOTE': [
    `ページ作成：らてぃ(@ratius55)<br>
\tご意見・不具合報告・データの間違い報告などは<a href="https://twitter.com/ratius55" target="_blank" rel="noopener noreferrer" title="作者のX">作者のX</a>まで`,
    'Original site developed by <a href="https://twitter.com/ratius55">ratius</a><br>For issues with the translated version, contact me <a href="https://twitter.com/lcheeseboy">on Twitter</a>'
  ],
  //LIVE ARENA
  'CONTENTS': [
    '目次',
    'Contents'
  ],
  'ARENA_PAGE_TITLE': [
    'ライブ♪アリーナ テキスト集',
    'Live♪Arena Story Collection'
  ],
  'FOREWORD_HEADER': [
    'まえがき',
    'Foreword'
  ],
  'ARENA_FOREWORD_INFO': [
    `<p>
      ゲーム「ラブライブ！スクールアイドルフェスティバル」内で定期開催されていたイベント「ライブ♪アリーナ」のテキスト集です。
    </p>
    <p>
      (2023/2/3) 私の知る範囲で、全てのテキストの掲載が完了。<br>
      欠けているテキストの補完に協力していただいた皆様に感謝。
    </p>`,
    `<p>
      Archive of messages from the recurring <i>Live♪Arena</i> events held in <i>Love Live! School Idol Festival</i>.
    </p>
    <p>
      (2023/2/3) As far as I know, the archive is complete.<br>
      Thank you to everyone who helped fill in the missing messages.
    </p>`
  ],
  'ARENA_STORY_HEADER': [
    '過去のテキスト',
    'Message Archive'
  ],
  'ARENA_STORY_INFO': [
    `<p>以下のいずれかを行うことで、表示回を切り替えることができます。</p>
		<ul>
			<li>上部のタイトル部分のセレクトボックスで、表示したい回を選択する</li>
			<li>上部の「前回」「次回」ボタンを押す</li>
			<li>テキスト部分にフォーカスを当てた状態で、キーボードのカーソルキーの左右を押す</li>
		</ul>`,
    `<p>To change which event is displayed, you can:</p>
		<ul>
			<li>Select an event from the dropdown menu at the top.</li>
			<li>Press the 'Previous' and 'Next' buttons in the top corners.</li>
			<li>When the message list is focused, use the left and right arrows on the keyboard.</li>
		</ul>`
  ],
  'PREV': [
    '前回',
    'Previous'
  ],
  'ARENA_MAIN_GROUP': [
    '本編テキスト',
    'Main Stories'
  ],
  'ARENA_OTHER_GROUP': [
    'その他',
    'Other Messages'
  ],
  'NEXT': [
    '次回',
    'Next'
  ],
  'ARENA_SUMMARY_HEADER': [
    'キャラ別登場回数',
    'Character Appearances'
  ],
  'ARENA_SUMMARY_INFO': [
    '各キャラクターの、ステージ1〜30のスペシャルセッションで登場した回数です。',
    'The number of times each idol has appeared in special sessions in rounds 1-29.'
  ],
  'MEMBER': [
    'キャラクター',
    'Member'
  ],
  'APPEAR_COUNT': [
    '登場回数',
    'Count'
  ],
  'APPEAR': [
    '登場回',
    'Appeared in Rounds'
  ],
  'UPDATE': [
    '更新履歴',
    'Update History'
  ],
  'UPDATE_NOTEXT': [
    '更新履歴（テキスト追加以外で）',
    'Update History (other than adding text)'
  ],
  'UPDATE_INFO': [
    '下のボックス内の、色つきの日付の行をクリックすると展開/折りたたみされます。',
    'Click to expand/collapse each row.'
  ],
  'BACK_TO_MAIN': [
    'トップページに戻る。',
    'Return to Homepage'
  ],
  // functions (not called with data-localize)
  'ARENA_ROUND_TITLE': [
    (num) => `第${num}回 ライブ♪アリーナ　`,
    (num) => `Live♪Arena Round ${num}: `
  ],
  'ARENA_ROUND_SUB': [
    (sub) => sub,
    (sub) => sub.startsWith('開催：') ? 'Held: ' + sub.substring(3) : sub
  ],
  'ARENA_ROUND_NUMBER': [
    (num) => `第${num}回`,
    (num) => `${num}`
  ],
  // other data
  'TRANSLATED_PAGES': {
    'llsif_arena.html': true
  }
}

Localization['ARENA_SITE_TITLE'] = 
  Localization.SITE_TITLE.map((title, index) =>
    `${Localization.ARENA_PAGE_TITLE[index]} | ${title}`
  );

// Functions for changing the language of the site

function getLang() {
  return +document.cookie.split('; ')
    .find(row => row.startsWith('lang='))
    ?.split('=')[1];
}

function setLang(lang) {
  lang_select = +lang;
  document.cookie = `lang=${lang};max-age=2678400;SameSite=Lax`;
  localizePage();
  const langEvent = new CustomEvent('SetLanguage', { lang: lang });
  document.dispatchEvent(langEvent);
}

var firstTime = true;
function localizePage() {
  const localizedElements = document.querySelectorAll('[data-localize]');
  localizedElements.forEach(element => {
    const key = element.dataset.localize;
    if(Localization[key] && Localization[key][lang_select]) {
      const locVal = Localization[key][lang_select];
      if(firstTime && lang_select === 0 && element.innerHTML.trim() !== locVal) {
        console.log('Localization data mismatch on key: ' + key);
      }
      if(element.dataset.localizeAttr) {
        element.attributes[element.dataset.localizeAttr].value = locVal;
      } else {
        element.innerHTML = locVal;
      }
    }
  });
  firstTime = false;
}

// init language selector
function initSelector() {
  const selector = document.getElementById('LanguageSelector');
  const langNames = Localization['LANG_NAME'];
  for(let i = 0; i < langNames.length; i++) {
    let optNode = new Option(langNames[i], i, false, i === lang_select);
    selector.appendChild(optNode);
  }
  selector.addEventListener('change', (event) => {
    this.setLang(event.target.value);
  })
}

let lang_select = getLang() ?? 0;
initSelector();
setLang(lang_select);