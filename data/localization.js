const Localization = {
  'LANG_CODE': [
    'JP',
    'EN'
  ],
  'LANG_NAME': [
    '日本語',
    'English'
  ],
  // HOMEPAGE
  'SITE_TITLE': [
    'ラブライブ！ストレージ',
    'Love Live! Storage'
  ],
  'CHOOSE_PANEL': [
    '↓ 見たいパネルを選んでね ↓',
    '↓ Select a Panel ↓'
  ],
  'GENERAL': [
    '総合',
    'GENERAL'
  ],
  'MEMBER_COLOR_TITLE': [
    'メンバーカラー<br>まとめ',
    'Member Color<br>Summary'
  ],
  'MEMBER_COLOR_DESC': [
    '各キャラクターのメンバーカラーを、色々な媒体から集めてみました。',
    'Collected image colors of each character from various media.'
  ],
  'NIJI_RANKING_TITLE': [
    '虹ヶ咲学園<br>マンスリーランキング',
    'Nijigasaki<br>Monthly Ranking'
  ],
  'NIJI_RANKING_DESC': [
    '毎月行われていたランキングの結果を、集計・分析してみました。',
    'The results of the monthly ranking, tabulated and analyzed.'
  ],
  'NIJI_QUESTION_TITLE': [
    '虹ヶ咲学園<br>マンスリーアンケート',
    'Nijigasaki<br>Monthly Questionaire'
  ],
  'NIJI_QUESTION_DESC': [
    '毎月行われているアンケートの集計や、便利リンクを掲載しています。',
    'Compilation of the monthly survey results, with links to each one.'
  ],
  'CHAR_SORT_TITLE': [
    'キャラソート',
    'Character Sorter'
  ],
  'CHAR_SORT_DESC': [
    'スクールアイドル、ユニット、キャスト等を好きな順に並べ替えてみよう。ツイートボタンも付いてるよ。',
    'Sort School Idols, Subunits, Seiyuu, etc. to order your favorites.  You can tweet your results as well.'
  ],
  'SIF': [
    'キャラソート',
    'SIF'
  ],
  'LIVE_ARENA_TITLE': [
    'ライブ♪アリーナ<br>テキスト集',
    'Live♪Arena<br>Story Collection'
  ],
  'LIVE_ARENA_DESC': [
    '今までに開催された、ライブ♪アリーナのテキストを保管しています。',
    'Story data of the Live♪Arena events that have been held so far'
  ],
  'BOOST_TITLE': [
    'ブーストリピート用<br>部員一覧',
    'Boost Repeat Skill<br>Member List'
  ],
  'BOOST_DESC': [
    'スクフェスのブーストリピート編成で使える部員の一覧です。<br>（別サイトへ移動します）',
    'Members whose boost repeat skills can be used together.<br>(opens in a new tab)'
  ],
  'TRANSFER_STUDENT_TITLE': [
    '転入生<br>データベース',
    'Transfer Student<br>Database'
  ],
  'TRANSFER_STUDENT_DESC': [
    'もう見られない転入生の情報やサイドストーリーを補完しています。現在テスト公開中。',
    'Transfer student information and side stories.  Development in progress.'
  ],
  'SIFAS': [
    'スクスタ',
    'SIF:AS'
  ],
  'NAME_TABLE_HEADER': [
    '呼称表',
    'Names, Nicknames & Honorifics'
  ],
  'NAME_TABLE_DESC': [
    '３０人のスクールアイドルとあなたは、お互いのことをどう呼び合っでいる？',
    'How do the 30 School Idols (and you) refer to each other?'
  ],
  'CARD_IMPL_HEADER': [
    'カード実装状況',
    'Card Statistics'
  ],
  'CARD_IMPL_DESC': [
    'スクスタにおいて、キャラ別のカードがどれくらいあるかを確認できます。',
    'How many cards has each character gotten in All Stars?'
  ],
  'EVENT_SUMMARY_HEADER': [
    '過去のイベント<br>まとめ',
    'Event Database'
  ],
  'EVENT_SUMMARY_DESC': [
    'スクスタのイベントストーリーで開催されたイベント、および共演したペアのまとめです。',
    'Data on past events, including featured UR and SR units.'
  ],
  'STORY_SUMMARY_HEADER': [
    'ストーリー便覧',
    'Story Summaries'
  ],
  'STORY_SUMMARY_DESC': [
    'スクスタの各種ストーリーのあらすじと登場キャラを、ひとまとめにしてみました。',
    'Synopses of the story chapters and which characters appeared therein.'
  ],
  'DAILY_THEATRE_HEADER': [
    '毎日劇場<br>データベース',
    'Daily Theatre'
  ],
  'DAILY_THEATRE_DESC': [
    'スクフェスの毎日劇場の一覧です。どんなストーリーがある？',
    'List of Daily Theatre episodes.'
  ],
  'AUTHOR_NOTE': [
    'ご意見・データの間違い報告などは<a href="https://twitter.com/ratius55">作者のTwitterまで</a>',
    'Original site developed by <a href="https://twitter.com/ratius55">ratius</a><br>For issues with the translated version, contact me <a href="https://twitter.com/lcheeseboy">on Twitter</a>'
  ],
  //LIVE ARENA
  'CONTENTS': [
    '目次',
    'Contents'
  ],
  'ARENA_PAGE_TITLE': [
    'ライブ♪アリーナ テキスト集',
    'Live♪Arena Story Collection'
  ],
  'FOREWORD_HEADER': [
    'まえがき',
    'Foreword'
  ],
  'ARENA_FOREWORD_INFO': [
    `<p>
      ゲーム「ラブライブ！スクールアイドルフェスティバル」内で定期開催されていたイベント「ライブ♪アリーナ」のテキスト集です。
    </p>
    <p>
      (2023/2/3) 私の知る範囲で、全てのテキストの掲載が完了。<br>
      欠けているテキストの補完に協力していただいた皆様に感謝。
    </p>`,
    `<p>
      Archive of messages from the recurring <i>Live♪Arena</i> events held in <i>Love Live! School Idol Festival</i>.
    </p>
    <p>
      (2023/2/3) As far as I know, the archive is complete.<br>
      Thank you to everyone who helped fill in the missing messages.
    </p>`
  ],
  'ARENA_STORY_HEADER': [
    '過去のテキスト',
    'Message Archive'
  ],
  'ARENA_STORY_INFO': [
    `<p>以下のいずれかを行うことで、表示回を切り替えることができます。</p>
		<ul>
			<li>上部のタイトル部分のセレクトボックスで、表示したい回を選択する</li>
			<li>上部の「前回」「次回」ボタンを押す</li>
			<li>テキスト部分にフォーカスを当てた状態で、キーボードのカーソルキーの左右を押す</li>
		</ul>`,
    `<p>To change which event is displayed, you can:</p>
		<ul>
			<li>Select an event from the dropdown menu at the top.</li>
			<li>Press the 'Previous' and 'Next' buttons in the top corners.</li>
			<li>When the message list is focused, use the left and right arrows on the keyboard.</li>
		</ul>`
  ],
  'PREV': [
    '前回',
    'Previous'
  ],
  'NEXT': [
    '次回',
    'Next'
  ],
  'ARENA_SUMMARY_HEADER': [
    'キャラ別登場回数',
    'Character Appearances'
  ],
  'ARENA_SUMMARY_INFO': [
    '各キャラクターの、ステージ1〜30のスペシャルセッションで登場した回数です。',
    'The number of times each idol has appeared in special sessions in rounds 1-29.'
  ],
  'MEMBER': [
    'キャラクター',
    'Member'
  ],
  'APPEAR_COUNT': [
    '登場回数',
    'Count'
  ],
  'APPEAR': [
    '登場回',
    'Appeared in Rounds'
  ],
  'UPDATE': [
    '更新履歴',
    'Update History'
  ],
  'UPDATE_NOTEXT': [
    '更新履歴（テキスト追加以外で）',
    'Update History (other than adding text)'
  ],
  'UPDATE_INFO': [
    '下のボックス内の、色つきの日付の行をクリックすると展開/折りたたみされます。',
    'Click to expand/collapse each row.'
  ],
  'BACK_TO_MAIN': [
    'トップページに戻る。',
    'Return to Homepage'
  ],
  // functions (not called with data-localize)
  'ARENA_ROUND_TITLE': [
    (num) => `第${num}回 ライブ♪アリーナ　`,
    (num) => `Live♪Arena Round ${num}: `
  ],
  'ARENA_ROUND_SUB': [
    (sub) => sub,
    (sub) => sub.startsWith('開催：') ? 'Held: ' + sub.substring(3) : sub
  ],
  'ARENA_ROUND_NUMBER': [
    (num) => `第${num}回`,
    (num) => `${num}`
  ],
  // other data
  'TRANSLATED_PAGES': {
    'llsif_arena.html': true
  }
}

Localization['ARENA_SITE_TITLE'] = 
  Localization.SITE_TITLE.map((title, index) =>
    `${Localization.ARENA_PAGE_TITLE[index]} | ${title}`
  );

// Functions for changing the language of the site

function getLang() {
  return +document.cookie.split('; ')
    .find(row => row.startsWith('lang='))
    ?.split('=')[1];
}

function setLang(lang) {
  lang_select = +lang;
  document.cookie = `lang=${lang};max-age=2678400;SameSite=Lax`;
  localizePage();
  const langEvent = new CustomEvent('SetLanguage', { lang: lang });
  document.dispatchEvent(langEvent);
}


function localizePage() {
  const localizedElements = document.querySelectorAll('[data-localize]');
  localizedElements.forEach(element => {
    const key = element.dataset.localize;
    if(Localization[key] && Localization[key][lang_select]) {
      element.innerHTML = Localization[key][lang_select];
    }
  })
}

// init language selector
function initSelector() {
  const selector = document.getElementById('LanguageSelector');
  const langNames = Localization['LANG_NAME'];
  for(let i = 0; i < langNames.length; i++) {
    let optNode = new Option(langNames[i], i, false, i === lang_select);
    selector.appendChild(optNode);
  }
  selector.addEventListener('change', (event) => {
    this.setLang(event.target.value);
  })
}

let lang_select = getLang() ?? 0;
initSelector();
setLang(lang_select);